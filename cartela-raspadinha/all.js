class Animations{constructor(t,i,e,s){this.animRaspar=[];for(let e=0;e<i;e++){let i=("0000"+e).slice(-2),s=PIXI.Texture.from(`${t}-${i}.png`);this.animRaspar.push(s)}this.sprite=new PIXI.AnimatedSprite(this.animRaspar),this.setPosition(e,s),this.sprite.alpha=0,this.sprite.animationSpeed=.9,this.sprite.loop=!1}play(t){this.sprite.alpha=1,this.sprite.play(),this.sprite.onComplete=()=>{this.sprite.gotoAndStop(0),this.sprite.alpha=0,t()}}setPosition(t,i){this.sprite.position.set(t,i)}}class Btn{constructor(t,i,e){this.sprite=PIXI.Sprite.from(t),this.setPosition(i,e),this.sprite.interactive=!0,this.sprite.buttonMode=!0,this.sprite.on("pointerdown",(()=>this.setTexture(!0))).on("pointerup",(()=>this.setTexture(!1))).on("pointerover",(()=>this.onButtonOver())).on("pointerout",(()=>this.onButtonOut()))}setPosition(t,i){this.sprite.position.set(t,i)}setTexture(t){this.sprite.tint=t?8421504:16777215}onButtonOver(){this.sprite.scale.set(1.03)}onButtonOut(){this.sprite.scale.set(1)}}class BtnPlay extends Btn{constructor(t,i,e){super("btnPlay",i,e),this.app=t,this.state=1,this.sprite.on("pointerdown",(()=>this.setTexture(!0))).on("pointerup",(()=>this.setTexture(!1)))}setTexture(t){let i;1==this.state?i=t?"btnPlayAcao":"btnPlay":2==this.state&&(i=t?"btnToqueAcao":"btnToque"),this.sprite.texture=PIXI.Texture.from(i)}}class CardItem{constructor(t,i,e,s){this.app=t,this.sprite=PIXI.Sprite.from(i),this.sprite.position.set(e,s),this.revealed=!1,this.sprite.interactive=!0,this.sprite.buttonMode=!0,this.sprite.on("pointerover",(()=>{this.app.dragging&&!this.revealed&&(this.revealed=!0)})),this.sprite.on("pointerdown",(()=>{this.app.dragging&&!this.revealed&&(this.revealed=!0)}))}}class Cartela{constructor(t,i,e){this.app=t,this.lastDrawnPoint=null,this.dragging=!1,this.revelado=!1,this.line=new PIXI.Graphics,this.brush=(new PIXI.Graphics).beginFill(16777215).drawCircle(0,0,50),this.stageSize={width:400,height:360},this.imgCobertura=Object.assign(PIXI.Sprite.from("areaToque"),this.stageSize),this.imageToReveal=Object.assign(PIXI.Sprite.from("premio"),this.stageSize),this.renderTexture=PIXI.RenderTexture.create(this.stageSize),this.renderTextureSprite=new PIXI.Sprite(this.renderTexture),this.setPosition(i,e),this.app.areaRaspagem.addChild(this.imgCobertura,this.imageToReveal,this.renderTextureSprite),this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this),this.mouseMove=this.mouseMove.bind(this),this.imgCobertura.interactive=!0,this.imgCobertura.buttonMode=!0,this.imgCobertura.hitArea=this.screen,this.imgCobertura.eventMode="static",this.imgCobertura.on("pointerdown",this.pointerDown).on("pointerup",this.pointerUp).on("pointerupoutside",this.pointerUp).on("pointermove",this.mouseMove)}mouseMove(t){let{x:i,y:e}=t.data.global;if(i-=this.position.x,e-=this.position.y,this.dragging||app.dragging&&!app.modalOpen){this.brush.position.set(i,e);const t=this.renderTexture;app.renderer.render(this.brush,{renderTexture:t,clear:!1,skipUpdateTransform:!1}),this.lastDrawnPoint&&(this.line.clear().lineStyle({width:100,color:16777215}).moveTo(this.lastDrawnPoint.x,this.lastDrawnPoint.y).lineTo(i,e),app.renderer.render(this.line,{renderTexture:t,clear:!1,skipUpdateTransform:!1})),this.lastDrawnPoint=this.lastDrawnPoint||new PIXI.Point,this.lastDrawnPoint.set(i,e)}}pointerDown(t){this.dragging=!0,this.mouseMove(t)}pointerUp(){this.dragging=!1,this.lastDrawnPoint=null}setPosition(t,i){this.position={x:t,y:i},this.imgCobertura.position.set(this.position.x,this.position.y),this.imageToReveal.position.set(this.position.x,this.position.y),this.renderTextureSprite.position.set(this.position.x,this.position.y),this.imageToReveal.mask=this.renderTextureSprite}revelar(){const t=this.renderTexture;this.brush=(new PIXI.Graphics).beginFill(16777215).drawCircle(0,0,this.stageSize.width*this.stageSize.height),this.brush.position.set(this.stageSize.width/2,this.stageSize.height/2),app.renderer.render(this.brush,{renderTexture:t,clear:!1,skipUpdateTransform:!1}),this.revelado=!0}}let app,tweenMax=TweenMax;class Game extends PIXI.Application{constructor(t){super(t),this.gameStage=new PIXI.Container,this.stage.addChild(this.gameStage),this.areaRaspagem=new PIXI.Container,this.stage.addChild(this.areaRaspagem),this.cartelas=[],this.animRaspar=[],this.valores=[],this.animationRevelarStatus=!0,this.jogando=!1,this.modalOpen=!1,this.dragging=!1,this.stage.interactive=!0,this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this),this.stage.on("pointerdown",this.pointerDown).on("pointerup",this.pointerUp).on("pointerupoutside",this.pointerUp).on("pointermove",(t=>{if(0==this.dragging)return;if(1==this.modalOpen)return;if(0==this.jogando)return;let i=parseInt(t.data.global.x),e=parseInt(t.data.global.y),s=i,a=e,n=20,r=20;this.valores.forEach((t=>{if(!t.revealed){let i=t.sprite.getBounds();s<i.x+i.width&&s+n>i.x&&a<i.y+i.height&&a+r>i.y&&(t.revealed=!0)}}))})),this.onResize=this.onResize.bind(this)}init(){this.cf=Cf.H,this.modal=new Modal(this),this.stage.addChild(this.modal.sprite),this.containerAjuda=new ContainerModal(this,"Ajuda",50,50),this.configAjuda(),this.containerCoin=new ContainerModal(this,"Moedas",50,50),this.containerAuto=new ContainerModal(this,"Modo de jogo",50,50),this.backgroundGame=new PIXI.Sprite(PIXI.Texture.from(this.cf.background.image)),this.gameStage.addChild(this.backgroundGame),this.btnPlay=new BtnPlay(app,this.cf.btnPlay.x,this.cf.btnPlay.y),this.gameStage.addChild(this.btnPlay.sprite),this.btnPlay.sprite.on("pointerdown",(()=>{this.jogando?(this.animationRevelarStatus&&(this.animRaspar.forEach((t=>t.sprite.alpha=1)),this.animationRevelar()),this.revelarCards()):(this.jogando=!0,this.btnPlay.state=2,this.setCartelas())})),this.btnAuto=new Btn("bntAutomatico",this.cf.btnAuto.x,this.cf.btnAuto.y),this.gameStage.addChild(this.btnAuto.sprite),this.btnAuto.sprite.on("pointerdown",(()=>{this.modal.setContent(this.containerAuto.sprite),this.modal.open()})),this.btnAjuda=new Btn("btnAjuda",this.cf.btnAjuda.x,this.cf.btnAjuda.y),this.gameStage.addChild(this.btnAjuda.sprite),this.btnAjuda.sprite.on("pointerdown",(()=>{this.modal.setContent(this.containerAjuda.sprite),this.modal.open()})),this.btnComprar=new Btn("btnComprar",this.cf.btnComprar.x,this.cf.btnComprar.y),this.gameStage.addChild(this.btnComprar.sprite),this.btnComprar.sprite.on("pointerdown",(()=>{this.modal.setContent(null),this.modal.open()})),this.btnCoin=new Btn("btnCoin",this.cf.btnCoin.x,this.cf.btnCoin.y),this.gameStage.addChild(this.btnCoin.sprite),this.btnCoin.sprite.on("pointerdown",(()=>{this.modal.setContent(this.containerCoin.sprite),this.modal.open()})),this.credito=new TextBox("Créditos","22.00"),this.gameStage.addChild(this.credito.sprite),this.premio=new TextBox("Prêmio","0"),this.gameStage.addChild(this.premio.sprite),this.id=new TextoV("123456789"),this.gameStage.addChild(this.id.sprite),window.addEventListener("resize",this.onResize),this.onResize()}setCartelas(){this.cartelas=[],this.areaRaspagem.removeChildren(),this.cartelas.push(new Cartela(app,this.cf.cartela[0].x,this.cf.cartela[0].y)),this.cartelas.push(new Cartela(app,this.cf.cartela[1].x,this.cf.cartela[1].y)),this.setAnimRaspar(),this.arrayValores=["p1","p1","p1","p1","p1","p1","p1","p1","p1","p1","p1","p1"],this.valores=[],Cf.itensCard.forEach(((t,i)=>{t.forEach((t=>{let e=new CardItem(app,this.arrayValores[i],t.x,t.y);this.valores.push(e),this.cartelas[i].imageToReveal.addChild(e.sprite)}))}))}setAnimRaspar(){this.animRaspar=[],this.animRaspar.push(new Animations("animRaspar",20,this.cf.cartela[0].x,this.cf.cartela[0].y)),this.animRaspar.push(new Animations("animRaspar",20,this.cf.cartela[1].x,this.cf.cartela[1].y)),this.areaRaspagem.addChild(this.animRaspar[0].sprite),this.areaRaspagem.addChild(this.animRaspar[1].sprite)}revelarCards(){this.cartelas.forEach((t=>t.revelar())),this.jogando=!1,this.btnPlay.state=1}animationRevelar(t=0){t<this.animRaspar.length&&this.animRaspar[t].play((()=>{this.animationRevelar(t+1)}))}pointerDown(){this.dragging=!0}pointerUp(){this.dragging=!1,this.cartelas.forEach((t=>t.pointerUp())),this.checkReveledCardItem()}onResize(){let t="v";window.innerWidth/window.innerHeight>1280/720?(t="h",this.renderer.resize(1280,720)):(t="v",this.renderer.resize(720,1280)),this.setPosition(t)}setPosition(t){this.cf="h"==t?Cf.H:Cf.V,this.backgroundGame.texture=PIXI.Texture.from(this.cf.background.image),this.cartelas.forEach(((t,i)=>{let e=this.cf.cartela[i];t.setPosition(e.x,e.y),this.animRaspar[i].setPosition(e.x,e.y)})),this.btnPlay.setPosition(this.cf.btnPlay.x,this.cf.btnPlay.y),this.btnAuto.setPosition(this.cf.btnAuto.x,this.cf.btnAuto.y),this.btnAjuda.setPosition(this.cf.btnAjuda.x,this.cf.btnAjuda.y),this.btnComprar.setPosition(this.cf.btnComprar.x,this.cf.btnComprar.y),this.btnCoin.setPosition(this.cf.btnCoin.x,this.cf.btnCoin.y),this.modal.setPosition(this.cf.btnCloseModal.x,this.cf.btnCloseModal.y),this.credito.setPosition(this.cf.credito.x,this.cf.credito.y),this.premio.setPosition(this.cf.premio.x,this.cf.premio.y),this.id.setPosition(this.cf.id.x,this.cf.id.y),this.containerAjuda.setPosition(this.cf.tituloModals.x,this.cf.tituloModals.y),this.containerCoin.setPosition(this.cf.tituloModals.x,this.cf.tituloModals.y),this.containerAuto.setPosition(this.cf.tituloModals.x,this.cf.tituloModals.y)}checkReveledCardItem(){if(!this.jogando)return;let t=0,i=this.arrayValores.length;this.valores.forEach((i=>{i.revealed&&t++})),this.animationRevelarStatus=!(t>=1),t>=i&&(this.revelarCards(),this.btnPlay.setTexture(!1))}configAjuda(){let t=PIXI.Sprite.from("tabCoin1");t.position.set(0,0),this.containerAjuda.sprite.addChild(t)}}"use strict";window.onload=function(){app=new Game({transparent:!0,width:1280,height:720}),document.body.appendChild(app.view);const t=new TextLoading("0",app.screen.width/2,app.screen.height/2);app.stage.addChild(t),app.loader.baseUrl="assets/tema",app.loader.add("backgroundGameH","background_horizontal.png").add("backgroundGameV","background_vertical.png").add("areaToque","areaToque.webp").add("premio","premio.png").add("btnPlay","btnPlay.webp").add("btnPlayAcao","btnPlayAcao.webp").add("btnToque","btnToque.png").add("btnToqueAcao","btnToqueAcao.png").add("bntAutomatico","bntAutomatico.png").add("btnAjuda","btnAjuda.png").add("btnCoin","btnCoin.png").add("btnComprar","btnComprar.png").add("btnClose","btnClose.webp").add("p1","p1.png").add("animRaspar","animRaspar.json").add("tabCoin1","tabCoin1.webp").load((function(){t.alpha=0,app.init()})),app.loader.onProgress.add((i=>{t.text=parseInt(i.progress)+"%"})),app.loader.onLoad.add((t=>{}))};class Modal{constructor(t){this.app=t,this.sprite=new PIXI.Container,this.setPosition(0,0),this.status=0,this.animate=!1,this.content=null,this.x=0,this.y=0}open(){if(this.animate)return;this.animate=!0;let t=0;this.status?(this.status=0,t=-app.screen.width,this.app.modalOpen=!1):(this.status=1,t=0,this.app.modalOpen=!0),setTimeout((()=>{TweenMax.to(this.sprite,.2,{x:t,onComplete:()=>{this.animate=!1}})}),200)}setPosition(t,i){this.x=t,this.y=i,this.create(this.x,this.y)}create(t,i){this.sprite.removeChildren(),this.graphics=this.graphics?this.graphics.clear():"",this.graphics=new PIXI.Graphics,this.graphics.beginFill(0,.9),this.graphics.drawRect(0,0,app.screen.width,app.screen.height),this.graphics.endFill(),this.graphics.interactive=!0,this.sprite.addChild(this.graphics),this.btnClose=new Btn("btnClose",t,i),this.btnClose.sprite.on("pointerdown",(()=>{this.open()})),this.status=0,this.sprite.addChild(this.btnClose.sprite),this.sprite.position.set(-app.screen.width,0)}setContent(t){this.create(this.x,this.y),t&&this.sprite.addChild(t)}}class ContainerModal{constructor(t,i,e,s){this.app=t,this.sprite=new PIXI.Container;this.titulo=new PIXI.Text(i.toUpperCase(),{fontFamily:"Arial",fill:["#ffffff"],fontSize:65,fontWeight:700,lineJoin:"round",strokeThickness:10}),this.titulo.anchor.set(.5),this.titulo.position.set(100,50),this.sprite.addChild(this.titulo),this.setPosition(e,s)}setPosition(t,i){this.titulo.position.set(t,i)}}class TextLoading extends PIXI.Text{constructor(t,i,e,s){super(t,new PIXI.TextStyle(cfTextLoading)),this.anchor.set(.5),this.id=s,this.x=i,this.y=e}}class TextBox{constructor(t,i){this.sprite=new PIXI.Container;let e={fontFamily:"Arial",fill:["#ffffff"],fontSize:25,fontWeight:700,lineJoin:"round",strokeThickness:10};this.titulo=new PIXI.Text(t.toUpperCase(),e),this.titulo.anchor.set(.5),this.sprite.addChild(this.titulo),this.valor=new PIXI.Text(i.toUpperCase(),e),this.valor.anchor.set(.5),this.valor.position.set(0,35),this.sprite.addChild(this.valor),this.setFontSize(23,40)}setPosition(t,i){this.sprite.position.set(t,i)}setFontSize(t,i){this.titulo.style.fontSize=t,this.valor.style.fontSize=i}}class TextoV{constructor(t){this.sprite=new PIXI.Container;this.sprite.valor=new PIXI.Text(t.toUpperCase(),{align:"center",breakWords:!0,fontFamily:"Arial",fill:["#ffffff"],fontWeight:700,lineJoin:"round",strokeThickness:3,wordWrap:!0,wordWrapWidth:10}),this.sprite.valor.anchor.set(.5),this.sprite.addChild(this.sprite.valor),this.setFontSize(30)}setPosition(t,i){this.sprite.position.set(t,i)}setFontSize(t){this.sprite.valor.style.fontSize=t}}var Network={gameID:"",clientID:"",session:"",token:"",language:"",url:"",setup:function(t){let i=new URL(window.location.href);this.gameID="gameID="+i.searchParams.get("gameID"),this.clientID="clientID="+i.searchParams.get("clientID"),this.session="session="+i.searchParams.get("session"),this.token="token="+i.searchParams.get("token"),this.language="language="+i.searchParams.get("language"),this.url=i.searchParams.get("auth"),this.url=this.url+"index.php?&"+this.gameID+"&"+this.clientID+"&"+this.session+"&"+this.token+"&"+this.language+"&toPHP=app|"+i.searchParams.get("clientID")+"|"+i.searchParams.get("gameID");var e=this.url+"|config";Network.ajax(e),Parser.log(e),Network.userAtivo()},ajax:function(t){app.carregando(1),Parser.log("enviei :"+t);var i=new XMLHttpRequest;i.onreadystatechange=function(){4==this.readyState&&200==this.status&&(Parser.log("recebi: "+this.responseText),app.carregando(0),Parser.interpretador(this.responseText))},i.open("GET",t,!0),i.send()},userAtivo:function(){if(!JOGANDO||SEMACAO){let i=this.url+"|usuarioativo";var t=new XMLHttpRequest;t.onreadystatechange=function(){4==this.readyState&&200==this.status&&Parser.interpretador(this.responseText)},t.open("GET",i,!0),t.send()}setTimeout((function(){Network.userAtivo()}),3e4)}},Parser={tabelaPremiacao:[],tabelaBonusCaldeirao:[],qtdCliquesBonus:0,tbCliques:0,qtdCliques:0,arrayRevelarCasas:[["1,2,3","4,5,6","7,8,9","10,11,12","13,14,15"],["1,4,7,10,13","2,5,8,11,14","3,6,9,12,15"],["3,6,9,12,15","2,5,8,11,14","1,4,7,10,13"],["15,14,13","12,11,10","9,8,7","6,5,4","3,2,1"],["1,4,7,10,13","3,6,9,12,15","14,11,8,5,2"],["3,6,9,12,15","1,4,7,10,13","14,11,8,5,2"]],arrayVelocidadeBruxa:[360,350,346,342,338,334,330],vassourasTotal:0,clicks:0,balanceFinal:0,setBonus:!1,numClique:0,winFinal:0,interpretador:function(t){var i=t,e="";if(""!=i&&null!=i&&i!=e&&(e=i,"!"==(i=i.trim()).substr(0,1)&&"!"==i.substr(i.length-1,i.length)))for(var s=i.substr(1,i.length-1).replace("!",""),a=s.search("@")>-1?s.split("@"):[],n=a.length,r=0;r<n;r++)if(null!=a[r]&&""!=a[r]){var o=a[r].split("|"),h=o[0];t=o[1];this.log("PARSEANDO ACAO "+h+"..."+t),this.action(h,t)}},action:function(t,i){switch(t){case"startfig":i.replace("!","").split(",").forEach(((t,i)=>{app.viraDesenho(t,i+1)}));break;case"datavenda":app.setDatavenda(i);break;case"status":app.setStatus(i);break;case"ticketid":app.setTicketiID(i);break;case"combstart":i=i.split(","),this.tbCliques=i,this.qtdCliques=this.tbCliques.length,app.limpaDados();break;case"tb":this.tabelaPremios(i);break;case"balance":this.balance(i);break;case"balancewin":app.setCreditosWin(!1,i);break;case"balancefwin":app.setBalancefwin(!1,i);break;case"balancef":app.setBalancefwin(!1,i),app.setBalancefwin(!0,i);break;case"win":this.win(i);break;case"combstartbonus":this.tabelaBonusCaldeirao=i.split(","),this.qtdCliquesBonus=0;break;case"msgplaybonus":i=i.split(";"),c3_callFunction("mensagensBonus",[i[0],i[1]]);break;case"winbonus":this.winFinal=i;break;case"timebonus":c3_callFunction("populaTempo",[i]);break;case"vassourabonus":c3_callFunction("populaVassouras",[i]),this.vassourasTotal=i;break;case"msgpayBonus":c3_callFunction("populaMensagem",[i]);break;case"payBonus":break;case"coin":app.setCoin(i);break;case"tryBonus":i="true"==i?1:0,c3_callFunction("poupulaContinuaBonus",[i]);break;case"ini":app.helpInicio(i);break;case"ERRO":app.erro(i);break;case"tab":app.setTab(i);break;case"colorpr":app.setColorPrev(i);break;case"coins":i=i.split(";"),app.setCoins(i);break;case"msg":app.setMsg(i);break;case"nch":app.setNch(i);break;case"nchbonus":app.setNchBonus(i);break;case"mcr":app.setMcr(i);break;case"bns":app.setBns(i);break;case"bnsbonus":app.setBnsBonus(i);break;case"auto":app.fimAutomatico();break;case"bonus":app.setIframe(i);break;case"buylink":app.setIframe(i,!0)}},clicouObjeto:function(t,i){if(this.tbCliques){this.numClique=t;var e=this.tbCliques[this.numClique],s="";if(-1!=e.search(":")){s=e.split(":")[0],app.viraDesenho(s,i);var a=e.split("*")[1].split(";")[0],n=e.split("*")[1].split(";")[1],r=e.split("*")[1].split(";")[2];e.split("*")[1].split(";")[3];if(0!=n&&"0.00"!=n)app.marcaPrevisto(0,s,a);else{var o=e.split("*")[0].split(":")[1];o=o.replace(":",";").split(";"),app.animationWin(a,i);for(var h=0;h<o.length;h++){var p=this.tbCliques[parseInt(o[h]-1)];p=p.split(":")[0],app.marcaCasaAPisca(p,o.length,i,r,a)}app.marcaPrevisto(a,s),setTimeout((function(){Parser.tempoPiscaPremio()}),100)}}else s=e,app.viraDesenho(s,i);this.verificaFim()}},verificaFim:function(){this.numClique>=this.qtdCliques-1&&0==this.setBonus&&this.balance(this.balanceFinal)},mandaJogar:function(t){this.log("chamou jogar"),Network.ajax(Network.url+"|getticket")},mandaBonus:function(){this.log("chamou bonus"),Network.ajax(Network.url+"|getbonus")},mandaAcao:function(){this.log("getacao"),Network.ajax(Network.url+"|getacao")},tabelaPremios:function(t){this.tabelaPremiacao=[],t=t.split("*");for(var i=0;i<t.length;i++){var e=t[i].split("-")[0],s=t[i].split("-")[0],a=t[i].split("-")[1].split(";")[0],n=t[i].split("-")[1].split(";")[1];app.preencheTabela(e,a,s,n)}},balance:function(t){null!=t&&""!=t&&app.setCreditos(t)},win:function(t,i=!1){null!=t&&""!=t&&"0"!=t&&"0,00"!=t&&(this.winRodada=t)},revelarTudo:function(t,i,e=null){e=null==e?Math.floor(Math.random()*Parser.arrayRevelarCasas.length):e,Parser.log("rndRevelar "+e),Parser.log("qtd "+Parser.arrayRevelarCasas[e].length),setTimeout((function(){if(t<Parser.arrayRevelarCasas[e].length){for(var i=Parser.arrayRevelarCasas[e][t].split(","),s=0;s<i.length;s++){var a=i[s];Parser.log(a),app.chamaObj(a)}t++,Parser.revelarTudo(t,"",e)}}),100)},time:null,tempoPiscaPremio:function(){clearTimeout(Parser.time),Parser.time=setTimeout((function(){Parser.tempoPiscaPremio()}),2e3)},log:function(t){}};